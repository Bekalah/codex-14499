{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Codex 144:99 Layer Node",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "id",
    "slug",
    "title",
    "layer",
    "summary",
    "keywords",
    "geometry",
    "numerology",
    "safety",
    "provenance"
  ],
  "properties": {
    "id": {"type": "integer", "minimum": 0},
    "slug": {"type": "string", "pattern": "^[a-z0-9-]+$"},
    "title": {"type": "string"},
    "layer": {"type": "string", "enum": ["vesica", "tree", "fibonacci", "helix"]},
    "summary": {"type": "string"},
    "keywords": {
      "type": "array",
      "items": {"type": "string"},
      "minItems": 1
    },
    "geometry": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "grid": {
          "type": "object",
          "required": ["columns", "rows", "radius"],
          "properties": {
            "columns": {"type": "integer", "minimum": 1},
            "rows": {"type": "integer", "minimum": 1},
            "radius": {"type": "integer", "minimum": 1}
          }
        },
        "spiral": {
          "type": "object",
          "required": ["growth", "samples"],
          "properties": {
            "growth": {"type": "number", "exclusiveMinimum": 0},
            "samples": {"type": "integer", "minimum": 1}
          }
        },
        "helix": {
          "type": "object",
          "required": ["samples"],
          "properties": {
            "samples": {"type": "integer", "minimum": 1},
            "amplitude": {"type": "number", "minimum": 0},
            "frequency": {"type": "number", "minimum": 0}
          }
        }
      }
    },
    "numerology": {
      "type": "object",
      "required": ["triad", "heptad", "ennead", "paths", "lattice"],
      "properties": {
        "triad": {"type": "integer", "minimum": 1},
        "heptad": {"type": "integer", "minimum": 1},
        "ennead": {"type": "integer", "minimum": 1},
        "paths": {"type": "integer", "minimum": 1},
        "lattice": {"type": "integer", "minimum": 1}
      }
    },
    "safety": {
      "type": "object",
      "required": ["ndSafe", "motionOptIn", "minSweepSec", "notes"],
      "properties": {
        "ndSafe": {"type": "boolean"},
        "motionOptIn": {"type": "boolean"},
        "minSweepSec": {"type": ["integer", "null"], "minimum": 0},
        "notes": {"type": "string"}
      }
    },
    "provenance": {
      "type": "object",
      "required": ["sources", "reviewed", "confidence"],
      "properties": {
        "sources": {
          "type": "array",
          "items": {"type": "string"},
          "minItems": 1
        },
        "reviewed": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$"},
        "confidence": {"type": "string"},
        "archiveRef": {"type": "string"}
      }
    },
    "notes": {"type": "string"}
  }
}
